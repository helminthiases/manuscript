
<!--- functions --->
```{r exploration functions}
sys.source(file = '../R/metrics/HookwormTG.R', envir = knitr::knit_global())
```

<!--- settings --->
```{r exploration settings}
pathstr <- dirname(getwd())
```


# *EXPLORATORY ANALYSIS* \label{chapter:exploration}

The \hyperref[chapter:background]{background} chapter notes that this project focuses on *Hookworm disease*, henceforth all data explorations, modelling, and analysis are in relation to *Hookworm disease*, and prevalence is the dependent/outcome variable in every case.  In terms of data, the project's underlying data set is the Togo data set.  It is the best data set vis-&agrave;-vis minimal missing points, missing data pattern, and the number of records after excluding incomplete records; the missing data pattern is *missing completely at random*.


## In focus: Togo

The country of Togo lies within West Africa.  Its bordering countries are the Republic of Ghana, the Republic of Benin, and Burkina Faso.  The climate is a tropical wet dry climate (@CIA); the far northern tip is semi-arid.  \cref{fig:F0067} illustrates the elevation pattern across Togo, most of the country has an elevation value less than $400$ metres.  In general, most of Togo's citizens live in rural areas across the country (@CIA), and the estimated population density across most of the country is within the range $(0 \quad 1k]$ per square kilometre (\cref{fig:F0067}).

\vspace{10pt}

In terms of *Hookworm disease*, the focus of this project, \cref{tab:T0069} outlines Togo's latest **(a)** disability adjusted life years (DALY) per $100k$ inhabitants, i.e., the number of years lost to disability, ill-health, or early death per $100k$ inhabitants, and **(b)** prevalence per $100k$ inhabitants (@Lancet2020, @IHME2020).  The estimate of each metric is much higher than the global [average] estimate; cf. \cref{tab:T0069}, \cref{tab:T0023}, and \cref{tab:T0024}.  Over time Togo's prevalence per $100k$ inhabitants has peaked & troughed (@IHME2020).   The reason is not quite clear, but a mass drug administration study by Bronzan et al. (@Bronzan2018) \textit{``... found that in areas with high baseline prevalence of hookworm the risk of rebound of infection is high among children who do not receive bi-annual treatment.''}; this hints at a possible programme design problem.


```{r T0069}
terms <- HookwormTG(pathstr = pathstr)

terms %>%
  dplyr::mutate_all(linebreak) %>%
  kableExtra::kable(
    format = 'latex',
    digits = 3,
    format.args = list(big.mark = ','),
    booktabs = TRUE,
    escape = FALSE,
    linesep = '\\addlinespace',
    col.names = kableExtra::linebreak(c('metric', 'estimate', 'lower', 'upper')),
    caption = 'The 2019 disability adjusted life years (DALY) per $100k$ inhabitants, and prevalence per $100k$ inhabitants.  Data Source: \\href{https://vizhub.healthdata.org/gbd-compare/}{Institute for Health Metrics} $\\&$ \\href{https://www.thelancet.com/journals/lancet/issue/vol396no10258/PIIS0140-6736(20)X0042-0}{The Lancet Global Burden of Disease 2019}') %>%
  kableExtra::kable_styling(position = 'center', latex_options = 'hold_position', font_size = 7, full_width = FALSE) %>%
  kableExtra::add_header_above(c('', '', 'confidence\ninterval' = 2)) %>%
  kableExtra::add_footnote(label = 'prev.: Prevalence', notation = 'none')  %>%
  kableExtra::column_spec(column = 1, latex_column_spec = "l")

```


\vspace{10pt}


```{r F0068, fig.pos = 'h!', out.extra = 'trim=5 5 15 5, clip', out.height = '65%', out.width = '65%', fig.align = 'center', fig.cap = 'The elevation pattern across Togo.  Data Source: \\href{https://worldclim.org/data/worldclim21.html}{WorldClim}'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'extraneous', 'mapElevation.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```

\vspace{10pt}

```{r F0067, fig.pos = 'h!', out.extra = 'trim=5 5 15 5, clip', out.height = '65%', out.width = '65%', fig.align = 'center', fig.cap = 'The 2015 population density pattern across Togo.  Data Source: \\href{https://sedac.ciesin.columbia.edu/data/collection/gpw-v4}{Gridded Population of the World}'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'extraneous', 'mapPopulation.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```




## Geohelminths Infections Survey Experiments: Distributions of Sites & Prevalence

```{r T0007, fig.pos = 'h!'}
T <- read.csv(file = file.path(dirname(getwd()), 'warehouse', 'reference', 'frequencies', 'timeFrequencies.csv'))

T %>%
  dplyr::mutate_all(linebreak) %>%
  kableExtra::kable(
    format = 'latex',
    booktabs = TRUE,
    escape = FALSE,
    linesep = '\\addlinespace',
    col.names = kableExtra::linebreak(c('year', '\\makecell[l]{number of \\\\ sites}')),
    caption = 'A tally of Togo\'s geohelminths infections survey experiments sites, i.e., records; per year a site is associated with a single record.') %>%
  kableExtra::kable_styling(position = 'center', latex_options = 'hold_position', font_size = 7, full_width = FALSE) %>%
  kableExtra::column_spec(column = 1, italic = TRUE, latex_column_spec = "l") %>%
  kableExtra::column_spec(column = 2, latex_column_spec = "m{0.135\\\\linewidth}l", latex_valign = 'm')

```

\vspace{10pt}

\cref{fig:F0001} illustrates the distribution of survey experiments sites across Togo; \cref{tab:T0007} summarises the number of sites per year.  The data set's survey experiments occurred during the years $2009$ & $2015$.  However, the years only have $4$ survey experiments sites in common, hence the questions

\vspace{5pt}

> * How similar or dissimilar are proximal survey experiment sites vis-&agrave;-vis probable risk factors?
>
> * Is it possible to infer the $2009$ prevalence of a site, which was only surveyed in $2015$, via the prevalence of proximal $2009$ locations - and vice versa?
>
> * Are there sufficient data points for determining possible patterns of association between *prevalence* & *probable risk factors* - considering the disparate distribution of sites across the years?

\vspace{5pt}


<!--- survey experiments sites
      trim: left bottom right top --->
```{r F0001, fig.pos = 'h!', out.extra = 'trim=5 5 15 5, clip', out.height = '80%', out.width = '80%', fig.align = 'center', fig.cap = 'The distribution of geohelminths infections survey experiments sites in Togo during the years $2009$ $\\&$ $2015$; the years only have 4 sites in common.'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'distributions', 'mapDistributions.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```

\vspace{5pt}

\noindent These questions have a bearing on explanatory model development, and partly define the limitations of any developed models.

\vspace{10pt}

\cref{fig:F0002} illustrates the prevalence distributions during the years $2009$ & $2015$.  It is tempting to state that *there have been improvements, over time, in relation to reducing prevalence*; alas, the statement is questionable because the years only have $4$ sites in common.

\vspace{10pt}

Setting aside the disparate $2009$ & $2015$ sites, do the prevalence distributions reflect *generic patterns of prevalence distributions overtime due to interventions*?    Unclear.  Yes, the aim of interventions is the reduction of INI prevalence over time, but it is improbable that all interventions have been successful, and patterns of prevalence distribution over time probably depend on starting prevalence values.

\vspace{10pt}

<!--- prevalence --->
```{r F0002, fig.pos = 'h!', out.width = '60%', fig.align = 'center', fig.cap = 'The distribution of geohelminths infections prevalence during the years 2009 and 2015'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'distributions', 'densityDistributions.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```


## WaSH

\cref{fig:F0003} illustrates the relationship between $prevalence$ & the access values of three WaSH (water, sanitation, and hygiene) variables: $piped\;sewer$, $unpiped\;sewer$, and *surface sewer*, i.e., open defaecation.  Each graph's prevalence values are actually *empirical logit*(*prevalence*) values:
\begin{equation}
\textit{empirical} \; \textit{logit}(\textit{prevalence}) = \frac{p + 0.5}{n + 0.5} (\#eq:0023)
\end{equation}
wherein
\begin{align}
  p: & \; \text{\# of inhabitants that test positive} \nonumber \\
  n: & \; \text{\# of inhabitants that test negative} \nonumber
\end{align}
in acknowledgement of the fact that the project's focus is Binomial models.  The fitted lines are for pattern investigation purposes, and the fitting functions, throughout this chapter, are **(a)** dashed lines: $y = mx + c$,^[$y = mx + c$ is the equation of a straight line wherein $m$ is the gradient, and $c$ is the intercept.] and **(b)** solid lines: cubic splines.

\vspace{10pt}

It is difficult to definitively state the relationship patterns of \cref{fig:F0003}.  The $piped \; sewer$ graph exhibits the strongest relationship pattern  - according to the fitting function $y = mx + c$, each year's prevalence decreases with increasing access to piped sewers.

```{r F0003, fig.pos = 'h!', out.height = '82.5%', out.width = '82.5%', fig.align = 'center', fig.cap = 'The relationships between $\\textit{Hookworm disease}$ prevalence $\\&$ access to sewage facilities; $1 \\equiv 100\\%$, which means $100\\%$ of the population has access.  The fitted lines are for pattern observation purposes, and the fitting functions are $y = mx + c$ $\\&$ $\\textit{cubic splines}$, dashed lines $\\&$ solid lines, respectively.'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'sewer', 'disaggregateSewerReal.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```

\clearpage

## Elevation

\cref{fig:F0007} illustrates the relationship between *prevalence* & *elevation*.  A definitive relationship is not discernible.  Each year, to varying degrees, the graph suggests an inverse relationship between prevalence and elevation.

```{r F0007, fig.pos = 'h!', out.height = '65%', out.width = '65%', fig.align = 'center', fig.cap = 'The relationships between $\\textit{Hookworm disease}$ prevalence and elevation.  The fitted lines are for pattern observation purposes, and the fitting functions are $y = mx + c$ $\\&$ $\\textit{cubic splines}$, dashed lines $\\&$ solid lines, respectively.'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'extraneous', 'disaggregateElevationReal.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```

## Population Density

\cref{fig:F0013} illustrates the relationship between *prevalence* & *population density*.  Again, a definitive relationship is not discernible, but it is possible that prevalence is inversely proportional to population density.

```{r F0013, fig.pos = 'h!', out.height = '65%', out.width = '65%', fig.align = 'center', fig.cap = 'The relationships between $\\textit{Hookworm disease}$ prevalence and population density.  The fitted lines are for pattern observation purposes, and the fitting functions are $y = mx + c$ $\\&$ $\\textit{cubic splines}$, dashed lines $\\&$ solid lines, respectively.'}
knitr::include_graphics(
  path = file.path('..', 'warehouse', 'reference', 'extraneous', 'disaggregatePopulationDensityLN.pdf'),
  auto_pdf = getOption(x = "knitr.graphics.auto_pdf", default = TRUE),
  dpi = NULL,
  error = getOption(x = "knitr.graphics.error", default = TRUE)
)
```
