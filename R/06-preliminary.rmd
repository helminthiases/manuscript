

```{r L0002}
sys.source(file = 'descriptions/DescriptionAlgorithms.R', envir = knitr::knit_global())
```


# *PRELIMINARY INVESTIGATION* \label{chapter:preliminary}

The previous *Chapter* graphically explores empirical relationships between *Hookworm disease* prevalence & a few extraneous independent variables.  This *Chapter*, and the next one \autoref{chapter:geo}, focuses on plausible empirical relationships models.

As noted before, this project's outcome of interest is *prevalence*, i.e., *Hookworm disease* prevalence.  Hence, all empirical relationship model investigations - between *prevalence* and zero or more extraneous independent variables - are **Binomial model** investigations.  In preparation for Binomial geostatistical modelling, the objective of this chapter is to

> *investigate evidence of residual spatial correlation in the residuals of preliminary empirical relationship models between ``prevalence`` and zero or more ``extraneous independent variables``.*

Each **preliminary model** is a Binomial generalised linear mixed model (GLMM).  The chapter tests for evidence of residual spatial correlation, per Binomial GLMM, via the empirical variogram.  The empirical variogram function determines the degree of spatial correlation in a stochastic process or random field [@Cressie1993], [@Matheron1963].

The next chapter reconfigures each GLMM that exhibits evidence of residual spatial correlation; in each case the underlying algorithm becomes a Binomial geo-statistical model.  Hence, an implicit purpose of this chapter is the determination of plausible fixed term effects vectors for geo-statistical modelling.


\cref{tab:T0004} summarises this chapter's common notations.

```{r T0004}

terms <- DescriptionAlgorithms()

terms %>%
  dplyr::mutate_all(linebreak) %>%
  kableExtra::kable(
    format = 'latex',
    booktabs = TRUE,
    escape = FALSE,
    linesep = '\\addlinespace',
    col.names = kableExtra::linebreak(c('notation', 'description')),
    caption = 'The notations used at various points of this chapter.') %>%
  kableExtra::kable_styling(position = 'center', latex_options = 'hold_position', font_size = 7, full_width = FALSE) %>%
  kableExtra::add_footnote(label = '', notation = 'none')  %>%
  kableExtra::column_spec(column = 1, italic = TRUE, latex_column_spec = "l") %>%
  kableExtra::column_spec(column = 2, latex_column_spec = "m{0.465\\\\linewidth}l", latex_valign = 'm')

```



## The Generalised Linear Mixed Models

The key assumptions of these models are

> * The observations are independent.
>
> * The values of each independent variable are error free.

\vspace{10pt}

The **preliminary model** algorithm in focus is the **generalised linear mixed model** (GLMM) of structure
\begin{align}
Y_{i} & \sim Binomial(e_{i}, p_{i}) (\#eq:0001) \\
\eta_{i} & = ln \left( \frac{p_{i}}{1 - p_{i}} \right) \nonumber \\
& = \mathbf{\delta}(x_{i})^{T} \mathbf{\beta} + b_{i} + c_{i} \nonumber
\end{align}
wherein
\begin{align}
\mathbf{b} & \sim \mathcal{N}(0, \tau^{2}_{b}\mathbf{I}_{b}) (\#eq:0002) \\
\mathbf{c} & \sim \mathcal{N}(0, \tau^{2}_{c}\mathbf{I}_{c}) \nonumber
\end{align}

It is a Binomial GLMM because the outcome values, prevalence, are proportions.  \cref{tab:T0004} defines the terms of each equation.  The expression $\mathbf{\delta}(x_{i})^{T} \mathbf{\beta}$ (\cref{eq:0001}) is the *fixed effects* expression; $\mathbf{\delta}(x_{i})$ is a vector of terms that depend on one or more independent variables, whilst $\mathbf{\beta}$ is the vector of associated regression coefficients (\cref{tab:T0001}).  In this investigation, the independent variables are the aforementioned WaSH variables, population density, and elevation (\cref{tab:T0003}).

Additionally, $b_{i}$ & $c_{i}$ are the random effects terms in relation to ``identifier`` & ``year``, respectively.  \cref{eq:0002} outlines the assumptions underlying the random effects vectors, i.e., each is

\vspace{10pt}

> * Mutually independent, and identically distributed.

* Normally distributed.

\vspace{10pt}

The length of the diagonal of identity matrix $\mathbf{I}_{b}$ is the number of distinct locations, whilst the diagonal length of $\mathbf{I}_{c}$ is the number of distinct years.  A second  **generalised linear mixed model** (GLMM) structure
\begin{align}
Y_{i} & \sim Binomial(e_{i}, p_{i}) (\#eq:0006) \\
\eta_{i} & = ln \left( \frac{p_{i}}{1 - p_{i}} \right) \nonumber \\
& = \mathbf{\delta}(x_{i})^{T} \mathbf{\beta} + b_{i} \nonumber
\end{align}
wherein
\begin{equation}
\mathbf{b} \sim \mathcal{N}(0, \tau^{2}_{b}\mathbf{I}_{b}) (\#eq:0007)
\end{equation}
models the data of a single year.

## Modes of Evaluation

The assessment of each considered GLMM model is via the hypotheses

\vspace{10pt}

> $H_{0}: \beta_{j} = 0$

$H_{1}: \beta_{j} \neq 0$

\vspace{10pt}

Let $0.05$ be the $p_{value}$ significance level, then there is evidence in favour of the alternative hypothesis, $H_{1}$, if the estimated coefficient's $p_{value} < 0.05$.  The comparison of the models, w.r.t. the same GLMM structure, is via deviance/AIC (Akaike Information Criterion).

## Prospective Models

The fixed term vectors of the best models, wherein each $\beta_{j}$ is statistically significant across GLMM structures, are
\begin{equation}
\mathbf{\delta}(x_{i}) =
\begin{cases}
[1, piped\underline{\hspace{0.125cm}}sewer, piped\underline{\hspace{0.125cm}}sewer^{2}, elevation.km] \\
[1, piped\underline{\hspace{0.125cm}}sewer, ln(p_density.k), elevation.km]
\end{cases} (\#eq:0005)
\end{equation}
In the case of
\begin{equation}
\mathbf{\delta}(x_{i}) = [1, piped\underline{\hspace{0.125cm}}sewer, surface\underline{\hspace{0.125cm}}sewer, elevation.km]
\end{equation}
the coefficient of $surface\underline{\hspace{0.125cm}}sewer$ is not significant across GLMM structures.^[And, unsurprisingly, the coefficient is not significant in the geo-statistical models.]


The exploratory data analysis illustrates ... years 2009 & 2015 only have 4 locations/sites in common.  Within the GLMM results table/s, the variance of random effect `year` is not negligible ... similar trend, varying degree?


## Prospective Models & Residual Spatial Correlation

**Hence**, focusing on single year data, *Figure ...* is the empirical variogram of the residuals due to *Expression ...*.  There is strong evidence of residual spatial correlation.  Hence, a model that addresses the spatial correlation, and missing knowledge, is required.


