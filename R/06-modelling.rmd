
```{r L0002}
sys.source(file = 'descriptions/DescriptionAlgorithms.R', envir = knitr::knit_global())
```


# *MODELLING*

The predominant focus of this chapter is **explanatory modelling**, for determining whether a set of WaSH (water, sanitation, and hygiene) variables, and population density, have a significant impact on the prevalence of \textcolor{darkgrey}{Hookworm disease}.  An explanatory model determines which variables have a statistically significant impact on *Hookworm disease* prevalence, and their degree of impact.  Additionally, whether this project's set of statistically significant variables is sufficient for predictive modelling is a brief focus.

\cref{tab:T0004} summarises this chapter's common notations.

```{r T0004}

terms <- DescriptionAlgorithms()

terms %>%
  dplyr::mutate_all(linebreak) %>%
  kableExtra::kable(
    format = 'latex',
    booktabs = TRUE,
    escape = FALSE,
    linesep = '\\addlinespace',
    col.names = kableExtra::linebreak(c('notation', 'description')),
    caption = 'The notations used at various points of this chapter.') %>%
  kableExtra::kable_styling(position = 'center', latex_options = 'hold_position', font_size = 7, full_width = FALSE) %>%
  kableExtra::add_footnote(label = '', notation = 'none')  %>%
  kableExtra::column_spec(column = 1, italic = TRUE, latex_column_spec = "l") %>%
  kableExtra::column_spec(column = 2, latex_column_spec = "m{0.465\\\\linewidth}l", latex_valign = 'm')

```






## Preliminary Investigation

Foremost, an investigation of the possible existence of unknown explanatory variables via the empirical variogram.  The empirical variogram function determines the degree of spatial correlation in a stochastic process or random field [@Cressie1993], [@Matheron1963].    Herein, we apply the empirical variogram function to the residuals of a **preliminary model**.  The implicit assumption being $\mapsto$ *evidence of the existence of unknown explanatory variables resides in the residuals*.  Subsequently, if the residuals do exhibit spatial correlation, and there are no other explanatory variables to consider, the unknown explanatory variables can be modelled as a stochastic process in a geo-statistical model.  To this end, this investigation serves a second purpose, the determination of plausible fixed term effects vectors for geo-statistical modelling.

<br>
<br>

The **preliminary model** algorithm in focus is the **generalised linear mixed model** (GLMM) of structure
\begin{align}
Y_{i} & \sim Binomial(e_{i}, p_{i}) (\#eq:0001) \\
\eta_{i} & = ln \left( \frac{p_{i}}{1 - p_{i}} \right) \nonumber \\
& = \mathbf{\delta}(x_{i})^{T} \mathbf{\beta} + b_{i} + c_{i} \nonumber
\end{align}
wherein
\begin{align}
\mathbf{b} & \sim \mathcal{N}(0, \tau^{2}_{b}\mathbf{I}_{b}) (\#eq:0002) \\
\mathbf{c} & \sim \mathcal{N}(0, \tau^{2}_{c}\mathbf{I}_{c}) \nonumber
\end{align}

It is a Binomial GLMM because the outcome values, prevalence, are proportions.  \cref{tab:T0004} defines the terms of each equation.  The expression $\mathbf{\delta}(x_{i})^{T} \mathbf{\beta}$ (\cref{eq:0001}) is the *fixed effects* expression; $\mathbf{\delta}(x_{i})$ is a vector of terms that depend on one or more independent variables, whilst $\mathbf{\beta}$ is the vector of associated regression coefficients (\cref{tab:T0001}).  In this investigation, the independent variables are the aforementioned WaSH variables, population density, and elevation (\cref{tab:T0003}).

Additionally, $b_{i}$ & $c_{i}$ are the random effects terms in relation to ``identifier`` & ``year``, respectively.  \cref{eq:0002} outlines the assumptions underlying the random effects vectors, i.e., each is

\vspace{10pt}

> * Mutually independent, and identically distributed.
>
> * Normally distributed.

\vspace{10pt}

The length of the diagonal of identity matrix $\mathbf{I}_{b}$ is the number of distinct locations, whilst the diagonal length of $\mathbf{I}_{c}$ is the number of distinct years.  A second  **generalised linear mixed model** (GLMM) structure
\begin{align}
Y_{i} & \sim Binomial(e_{i}, p_{i}) (\#eq:0006) \\
\eta_{i} & = ln \left( \frac{p_{i}}{1 - p_{i}} \right) \nonumber \\
& = \mathbf{\delta}(x_{i})^{T} \mathbf{\beta} + b_{i} \nonumber
\end{align}
wherein
\begin{equation}
\mathbf{b} \sim \mathcal{N}(0, \tau^{2}_{b}\mathbf{I}_{b}) (\#eq:0007)
\end{equation}
models the data of a single year.

### Modes of Evaluation

The assessment of each considered GLMM model is via the hypotheses

\vspace{10pt}

> $H_{0}: \beta_{j} = 0$
>
> $H_{1}: \beta_{j} \neq 0$

\vspace{10pt}

Let $0.05$ be the $p_{value}$ significance level, then there is evidence in favour of the alternative hypothesis, $H_{1}$, if the estimated coefficient's $p_{value} < 0.05$.  The comparison of the models, w.r.t. the same GLMM structure, is via deviance/AIC (Akaike Information Criterion).

### The Best Models

The fixed term vectors of the best models, wherein each $\beta_{j}$ is statistically significant across GLMM structures, are
\begin{equation}
  \mathbf{\delta}(x_{i}) =
  \begin{cases}
    [1, piped\underline{\hspace{0.125cm}}sewer, piped\underline{\hspace{0.125cm}}sewer^{2}, elevation.km] \\
    [1, piped\underline{\hspace{0.125cm}}sewer, ln(p_density.k), elevation.km]
  \end{cases} (\#eq:0005)
\end{equation}

In the case of
\begin{equation}
\mathbf{\delta}(x_{i}) = [1, piped\underline{\hspace{0.125cm}}sewer, surface\underline{\hspace{0.125cm}}sewer, elevation.km]
\end{equation}
the coefficient of $surface\underline{\hspace{0.125cm}}sewer$ is not significant across GLMM structures.^[And, unsurprisingly, the coefficient is not significant in the geo-statistical models.]

\vspace{25pt}

\textcolor{wine}{In progress ...}

*Figure ...* is the empirical variogram of the residuals due to *Expression ...*.  There is strong evidence of residual spatial correlation.  Hence, a model that addresses the spatial correlation, and missing knowledge, is required.

The exploratory data analysis illustrates ... Further investigation highlighted the important fact that the years 2009 & 2015 only have 4locations/sites in common.  Within the GLMM results table/s, the variance of the `year` suggests ...


## Geographic

The graphs of $\ldots$ illustrate that the distributions of the outcomes are not Gaussian. Additionally, the outcome, prevalence, is a proportion. Hence, the models of interest are Binomial.  The modelling section's focus is Binomial models.

## Geo-statistical binomial logistic models

The data, the exploratory analysis chapter, and the preliminary investigation, outline a few important

> * The outcomes - prevalence - are proportions, hence the project's focus is binomial models.
>
> * The exploratory data analysis illustrates a degree of **spatial** linear and/or non-linear relationship between prevalence levels and the extraneous variables^[Herein, extraneous variables are the variables that are not part of the original ESPEN geohelminths data variables].
>
> * The preliminary investigation outlines strong evidence of residual spatial correlation, within the residuals of a generalised linear mixed model (GLMM).


Hence, a strong rationale for geo-statistical binomial logistics models.  This section explores *geo-statistical binomial logistics models* whereby the parameter estimates are either

* Bayesian estimates, or
* Monte Carlo Maximum Likelihood estimates

In each case, the linear predictor is
\begin{equation}
\eta(x_{i}) = \mathbf{\delta}(x_{i})^{T} \mathbf{\beta} + S(x_{i}) + U_{i} (\#eq:0018)
\end{equation}

Again, $\mathbf{\delta}(x_{i})$ is the $i^{th}$ vector of fixed terms - i.e., the $i^{th}$ row vector of the model's design matrix - it depends on zero or more independent variables. Whilst $\mathbf{\beta}$ is the vector of the concurrent fixed effects coefficients.

$U_{i}$ are independent Normally distributed random variables.  $U_{i}$ capture *unstructured variation in $Y_{i}$*, i.e., capture the effects of unknown/unmeasured independent variables.  $U_{i} \sim \mathcal{N}(0, \nu^{2})$.

$S(x_{i})$ is a stochastic process term, it models *unexplained spatial variation* [reference].  Herein, the assumption is that $S(\mathbf{x})$ is

* A zero-mean gaussian process, i.e., the joint probability of ${S(x_{1}), \ldots, S(x_{n})}$ is multi-variate normal.
* Stationary, i.e., it has a constant variance - denoted $\sigma^{2}$.
* Isotropic, i.e., the correlation between $S(x_{i})$ & $S(x_{j})$ depends on the distance between $x_{i}$ & $x_{j}$ only.

A consequence of these assumptions is that the covariance $\gamma(x_{i}, x_{j})$ is defined as
\begin{equation}
\gamma(x_{i}, x_{j}) = \sigma^{2}\rho(\left\Vert x_{i} - x_{j} \right\Vert) (\#eq:0015)
\end{equation}

wherein $\rho(u) = \rho(\left\Vert x_{i} - x_{j} \right\Vert)$ is the correlation function; $u = \left\Vert \cdot \right\Vert$ denotes distance.  Throughout this paper correlation function in use is the *exponential correlation function* [@Diggle2019]
\begin{equation}
\rho(u; \phi) = e^{-u/\phi}, \qquad u \geq 0 (\#eq:0016)
\end{equation}
The term $\phi$ is the scale parameter.
